## 인덱스 머지
- 인덱스를 이용한 쿼리를 실행하는 경우 대부분 옵티마이저는 테이블별로 하나의 인덱스만 사용하도록 실행계획을 수립한다. 하나의 인덱스만 사용해서 작업 범위를 충분히 줄일 수 있는 경우라면 테이블별로 하나의 인덱스만 활용하는 것이 효율적이다.
- 인덱스 머지 실행 계획을 사용하면 하나의 테이블에 대해 2개 이상의 인덱스를 이용해 쿼리를 처리한다. 쿼리에 사용된 각각의 조건이 서로 다른 인덱스를 사용할 수 있고 그 조건을 만족하는 레코드 건수가 많을 것으로 예상 될 때 MySQL서버는 인덱스 머지 실행 계획을 선택한다.

### 인덱스 머지 - 교집합(index_merge_intersection)
- 실행계획의 Extra 컬럼에 `Using intersect`라고 표시되며 해당 쿼리가 여러개의 인덱스를 각각 검색해서 그 결과의 교집합만 반환한다.
- 옵티마이저에서 효과적으로 실행계획을 세우지만 단순히 인덱스 하나만 사용하는게 더 성능이 좋을 것으로 생각할 수도 있으므로 MySQL서버/현재 커넥션/현재 쿼리에 대해서만 `index_merge_intersection`최적화를 비활성화 할 수도 있다.

### 인덱스 머지 - 합집합(index_merge_union)
- WHERE 절에 사용된 2개 이상의 조건이 각각의 인덱스를 사용하되 OR 연산자로 연결된 경우에 사용되는 최적화
- `Union`알고리즘으로 각 인덱스를 사용한 결과를 병합하는데 각각의 결과가 프라이머리키로 이미 정렬되어 있어서 따로 정렬이 필요하지 않고 중복제거를 진행한다.
- 중복 제거를 수행할 때 사용된 알고리즘을 우선순위 큐라고 한다.

> SQL문장에서 AND 연산자와 OR 연산자는 상당히 큰 차이를 보인다. 2개의 조건이 AND로 연결된 경우에는 두 조건 중 하나라도 인덱스를 사용할 수 있으면 인덱스 레인지 스캔으로 쿼리가 실행되지만, OR 연산자의 경우 둘 중 하나라도 제대로 인덱스를 사용하지 못하면 항상 플 스캔으로 처리된다.

### 인덱스 머지 - 정렬 후 합집합(index_merge_sort_union)
- 만약 인덱스 머지 작업을 하는 도중에 결과의 정렬이 필요한 경우 MySQL 서버는 인덱스 머지 최적화의 `Sort Union` 알고리즘을 사용한다.
- 중복을 제거하기 위해 우선순위 큐를 사용하는 것이 불가능한 상황일 때 `index_merge_sort_union`최적화를 실행한다
- 실행계획 Extra 컬럼에 `Using sort_union`으로 표시된다
