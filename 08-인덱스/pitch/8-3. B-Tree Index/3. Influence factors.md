## 인덱스 사용에 영향을 미치는 요소
- 인덱스 키 값의 크기
  - InnoDB 엔진은 디스크에 데이터를 저장하는 기본 단위를 페이지(Page) 또는 블록(Block)이라고 하며, 디스크의 모든 읽기 및 쓰기 작업의 최소 작업단위가 된다. 인덱스도 결국 페이지 단위로 관리된다.
  - MySQL 의 B-Tree는 인덱스의 페이지 크기와 키 값의 크기에 따라 자식 노드를 몇개나 가질 수 있는지 결정된다.
  - MySQL 5.7 버전 이후 부터 InnoDB 엔진의 페이지 크기를 변수를 사용해 값을 설정할 수 있다.
    >- 인덱스 페이지: 16kb
    >- 인덱스 키: 16 byte
    >- 노드주소영역: 12 byte  
    > 인경우 16 * 1024 / (16+12) = 585개의 인덱스 키를 저장할 수 있음.
  - 따라서 인덱스 키가 커질 수록 한페이지에 담을 수 있는 인덱스 키의 수가 줄어들고 상황에 따라 한번 이상으로 디스크를 읽는 횟수가 늘어나게 되고 그만큼 느려진다는 의미이다.
  - 인덱스 키값의 길이가 길어지는 것 또한 인덱스의 크기가 커진다는 것을 의미한다.
  - InnoDB 버퍼 풀이나 MyISAM의 키 캐시 영역은 크기가 제한적이기 때문에 하나의 레코드를 위한 인덱스의 크기가 커지면 커질 수록 메모리에 캐시해 둘 수 있는 레코드 수는 줄어들고, 메모리 효율이 떨어지는 결과를 가져온다.
- B-Tree 깊이
  - 인덱스의 깊이는 상당히 중요하지만 직접 제어할 방법은 없다.
  - 인덱스 페이지에 담을 수 있는 인덱스의 키값이 줄어들면 같은 레코드 건수라고 하더라도 B-Tree의 깊이가 깊어져서 디스크 일기가 더 많이 필요하다.
  - 하지만 상용에서 B-Tree의 깊이가 5단계 이상까지 깊어지는 경우는 흔치 않다고 한다.
- 선택도(Selectivity)와 기수성(Cardinality)
  - 기수성은 특정 데이터 집합의 유니크한 값의 개수이다. 예를 들어 '성별'컬럼의 경우 남자와 여자라는 값만 가지기 때문에 기수성은 2이다. 반면에 주민등록번호는 모든 레코드가 고유한 값을 가지기 때문에 전체 레코드 개수와 기수성은 일치한다.
  - 선택도 = 기수성 / 전체 레코드 수
  - 선택도는 0 ~ 1사이의 값이며 1일 때 모든 값이 유니크하다는 뜻
- 읽어야 하는 레코드의 건수
  - 인덱스를 통해 테이블의 레코드를 읽는 것은 인덱스를 거치지 않고 바로 테이블의 레코드를 읽는 것보다 높은 비용이 드는 작업임.
  - 인덱스를 이용한 읽기의 손익 분기점을 판단해야함.
  - 일반적인 DBMS의 옵티마이저에서는 인덱스를 통해 레코드 1건을 읽는 것이 테이블에서 직접 레코드 1건을 읽는 것보다 4~5배정도 비용이 많이 드는 작업으로 예측한다.
  - 인덱스를 통해 읽어야 할 레코드의 건수가 전체 레코드의 20~25%를 넘어선다면 인덱스를 사용하지 않고 풀스캔후 필터링 방식으로 처리하는 것이 효율적임.