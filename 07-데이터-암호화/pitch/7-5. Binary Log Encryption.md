## 바이너리 로그 암호화
- 언두 로그와 리두 로그는 길지 않은 시간 동안의 데이터만 가지는 반면 바이너리 로그는 의도적으로 상당히 긴 시간 동안 보관하는 서비스도 있고 때로는 증분 백업을 위해 바이너리 로그를 보관하기도 하기 때문에 상황에 따라 바이너리 로그의 암호화는 중요도가 높이질 수 있다.
- 바이너리 로그와 릴레이 로그 파일 암호화 기능은 디스크에 저장된 로그 파일에 대한 암호화만 담당하고, 서버 메모리 내부, 소스서버와 레플리카 서버 간의 네트워크 구간에서 로그 데이터를 암호화 하지는 않는다.

### 1. 바이너리 로그 암호화 키 관리
- 바이너리 로그 암호화도 2단계 암호화 키관리 방식을 사용한다.
- 바이너리 로그와 릴레이 로그 파일의 데이터는 파일 키(File Key)로 암호화해서 디스크로 저장하고, 파일 키는 "바이너리 로그 암호화 키"로 암호화해서 각 바이너리 로그와 릴레이 로그 파일의 헤더에 저장된다.
"바이너리 로그 암호화 키"가 테이블 암호화의 마스터 키와 동일한 역할을하고, 파일 키는 바이너리 로그와 릴레이 로그 파일 단위로 자동으로 생성되어 해당 로그 파일의 데이터 암호화에만 사용된다.

### 2. 바이너리 로그 암호화 키 변경
- `ALTER INSTANCE ROTATE BINLOG MASTER KEY;` 명령어로 암호화 키를 변경할 수 있음.
> 1. 증가된 시퀀스 번호와 함께 새로운 바이너리 로그 암호화 키 발급후 키링 파일에 저장
> 2. 바이너리 로그 파일과 릴레이 로그 파일 스위치(새로운 로그 파일로 로테이션)
> 3. 새로 생성되는 바이너리 로그와 릴레이 로그 파일의 암호화를 위해 파일 키를 생성하고, 파일 키는 바이너리 로그 파일 키(마스터 키)로 암호화해서 각 로그 파일에 저장
> 4. 기존 바이너리 로그와 릴레이 로그 파일의 파일 키를 읽어서 새로운 바이너리 로그 파일 키로 암호화해서 다시 저장(암호화되지 않은 로그 파일은 무시)
> 5. 모든 바이너리 로그와 릴레이 로그 파일이 새로운 바이너리 로그 암호화 키로 다시 암호화됐다면 기존 바이너리 로그 암호화 키를 키링 파일에서 제거

### 3. mysqlbinlog 도구 활용
- 바이너리 로그 파일이 한번 암호화되면 바이너리 로그 암호화 키가 없으면 복호화가 불가능함.
- 바이너리 암호화 키는 MySQL 서버만 가지고 있어서 복호화가 불가능함.
- MySQL 서버와 관계없이 mysqlbinlog 도구만으로는 복호화할 방법이 없다.
- 따라서 mysqlbinlog 도구가 MySQL 서버에 접속해서 바이너리 로그를 가져오는 방법밖에 없다.